{% extends "layouts/base.html" %}

{% block title %} Dashboard {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

    <div class="container-fluid py-4">
        <div class="row">
            <div class="col-xl-6 col-sm-12 mb-xl-0 mb-4">
                <div class="card">
                    <div class="card-header p-3 pt-2">
                        <div class="pt-1">
                            <h4 class="text-sm mb-0 text-capitalize">Normal picture</h4>
                        </div>
                    </div>
                    <img id="inp" src="#" alt="your image"/>
                    <hr class="dark horizontal my-0">
                    <div class="card-footer p-3">
                    </div>
                    <input type="file" name="filename" onchange="readURL(this);"
                           accept="image/gif, image/jpeg, image/png">
                </div>
            </div>
            <div class="col-xl-6 col-sm-12 mb-xl-0 mb-4">
                <div class="card">
                    <div class="card-header p-3 pt-2">
                        <div class="pt-1">
                            <h4 class="text-sm mb-0 text-capitalize">Greyscale</h4>
                        </div>
                    </div>
                    <img id="grey" src="#" alt="your image"/>
                </div>
            </div>
        </div>

        {% include 'includes/footer.html' %}
    </div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

    <script src="/static/assets/js/plugins/chartjs.min.js"></script>
    <script>
        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    $('#inp').attr('src', e.target.result).width(600).height(600);
                };
                reader.readAsDataURL(input.files[0]);

                var fd = new FormData();
                fd.append('file', input.files[0]);
                $(function () {
                    $.ajax({
                        type: 'POST',
                        url: '/upload',
                        data: fd,
                        contentType: false,
                        cache: false,
                        processData: false,
                        success: function (response) {
                            var bytestring = response.img
                            var image = bytestring.split('\'')[1]
                            $('#grey').attr('src', 'data:image/jpeg;base64,' + image).width(600).height(600);
                            {#var binaryData = [];#}
                        },
                        error: function (error) {
                            console.error(error);
                        },
                        async: true,
                    });
                })
            }
        }
    </script>

{% endblock javascripts %}
